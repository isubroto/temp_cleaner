<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <Package Name="DeepCleaner"
           Manufacturer="Subroto Saha"
           Version="$(var.ProductVersion)"
           UpgradeCode="8ed2b67f-6148-4943-97a2-49d4c7a7dfec">
           
    <Media Id="1" Cabinet="media1.cab" EmbedCab="yes" />

    <!-- Upgrade handling -->
    <MajorUpgrade DowngradeErrorMessage="A newer version of DeepCleaner is already installed." />

    <!-- Directories -->
    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="subroto" Name="Subroto Saha">
        <Directory Id="INSTALLFOLDER" Name="DeepCleaner" />
      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="DesktopFolder">
      <Directory Id="DesktopShortcutDir" Name="." />
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ProgramMenuDir" Name="DeepCleaner" />
    </StandardDirectory>

    <!-- Shortcut Components (NOT the exe - that comes from Files.wxs) -->
    <Component Id="DesktopShortcut" Directory="DesktopShortcutDir" Guid="*">
      <Shortcut Id="DesktopAppShortcut"
                Name="DeepCleaner"
                Target="[INSTALLFOLDER]DeepCleaner.exe"
                Icon="AppIcon"
                WorkingDirectory="INSTALLFOLDER" />
      <RemoveFolder Id="RemoveDesktop" On="uninstall"/>
      <RegistryValue Root="HKCU" Key="Software\DeepCleaner\UI" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
    </Component>

    <Component Id="StartMenuShortcut" Directory="ProgramMenuDir" Guid="*">
      <Shortcut Id="StartMenuAppShortcut"
                Name="DeepCleaner"
                Target="[INSTALLFOLDER]DeepCleaner.exe"
                Icon="AppIcon"
                WorkingDirectory="INSTALLFOLDER" />
      <RemoveFolder Id="RemoveStartMenu" On="uninstall"/>
      <RegistryValue Root="HKCU" Key="Software\DeepCleaner" Name="startMenu" Type="integer" Value="1" KeyPath="yes"/>
    </Component>

    <!-- Icon -->
    <Icon Id="AppIcon" SourceFile="..\Images\Designer.ico"/>
    <Property Id="ARPPRODUCTICON" Value="AppIcon"/>

    <!-- Feature -->
    <Feature Id="ProductFeature" Title="DeepCleaner" Level="1">
      <!-- AppFiles from heat.exe includes DeepCleaner.exe and all other files -->
      <ComponentGroupRef Id="AppFiles" />
      <ComponentRef Id="DesktopShortcut"/>
      <ComponentRef Id="StartMenuShortcut"/>
    </Feature>

  </Package>
</Wix>