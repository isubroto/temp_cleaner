# .github/workflows/publish-to-winget.yml

name: Publish to Winget

# This workflow triggers automatically when a new release is published.
on:
  release:
    types: [published]

jobs:
  publish-winget:
    runs-on: windows-latest # wingetcreate runs on Windows
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      # The winget-create-and-submit-action by vedantmgoyal2009 is a fantastic community-driven action
      # that simplifies this entire process. It's a wrapper around `wingetcreate`.
      - name: Publish to Winget
        uses: vedantmgoyal2009/winget-releaser@v2
        with:
          # Your package's unique identifier. MUST be in the format "Publisher.AppName".
          # Replace this with your actual Package Identifier.
          identifier: YourCompany.YourApp

          # The GitHub token with public_repo scope (the PAT you created).
          token: ${{ secrets.WINGET_PAT }}

          # Optional: If your release tags have a 'v' prefix (e.g., "v1.2.3"),
          # this action will automatically remove it to get the version "1.2.3".
          # If your tags don't have a 'v', you can remove this line.
          strip-v: true

          # Optional: Specify the file extension of your installer.
          # This is useful if you have other files attached to the release.
          # For you, this is 'msi'. Other options could be 'exe', 'msix', etc.
          installer-type: msi
